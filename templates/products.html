{% extends "base.html" %}
{% block content %}
<br> <br>
<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
    Add Products
</button>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="staticBackdropLabel">Products</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="/add_products" class="form-control text-center" method="POST">
                    <label for="name">Product name</label> <br>
                    <input type="text" id="name" name="name"> <br> <br>
                    <label for="bp">Buying Price</label> <br>
                    <input type="number" id="bp" name="buying_price"> <br> <br>
                    <label for="sp">Selling Price</label> <br>
                    <input type="number" id="sp" name="selling_price"> <br> <br>
                    <button type="submit" class="btn btn-primary">Add product</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div> <br> <br>
<table class="display text-bg-primary container" id="myTable">
    <thead>
        <tr>
            <th>product_id</th>
            <th>name</th>
            <th>buying_price</th>
            <th>selling_price</th>
            <th>Edit</th>
            <th>Delete</th>
        </tr>

    </thead>

    <tbody>
        {% for products in my_products %}
        <tr>
            <td>{{products[0]}}</td>
            <td>{{products[1]}}</td>
            <td>{{products[2]}}</td>
            <td>{{products[3]}}</td>
            <td>
                <a href="{{ url_for('edit_product', product_id=products[0]) }}" class="btn btn-primary btn-sm">
                    <i class="fa-solid fa-pencil"></i> Edit
                </a>
            </td>
            <td>
                <form action="{{ url_for('delete_product', product_id=products[0])}}" method="POST" onsubmit="return confirm('Delete this item?')">
                    <!-- include CSRF token if your framework requires it -->
                    <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<!-- end block before Javascript -->
{% endblock %}

{% block script %}
let table = new DataTable('#myTable');
{% endblock %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.datatables.net/2.3.4/js/dataTables.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
    integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y"
    crossorigin="anonymous"></script>